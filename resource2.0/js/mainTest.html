<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">

		

		<title>util</title>
		<style type="text/css">
		</style>
		<script src="jquery-1.10.2.js" type="text/javascript"></script>
		<script src="hashmap.js" type="text/javascript"></script>
		<script src="constant.js" type="text/javascript"></script>
		<script src="util.js" type="text/javascript"></script>
		<script src="tube.js" type="text/javascript"></script>
		<script src="select.js" type="text/javascript"></script>
			

		<script type="text/javascript">
		
		
		
		
		
			function init(){
				var svgroot = document.getElementById("svgroot");
				var svgdoc = svgroot.ownerDocument;
				var container = document.getElementById("container");
				var fiberDistance = 15;
				var tubeDistance = 500;

				//初始化类
				resource.util.init({
					getDOMDocument: function() { return svgdoc; },
					getDOMContainer: function() { return container; },
					getSVGRoot: function() { return svgroot; },					
					getSVGContent: function() { return svgcontent; }
				});
				var group = document.getElementById("svgroot");
				
				
				var cablejson = {"cableId":"120101000001",
	
	"tubeNum":12,
	
	"fiberNumPerTube":12,
	
	"subTubes":[{"tubeIndex":11,"cableId":"120101000002","fiberNum":12},{"tubeIndex":10,"cableId":"120101000006","fiberNum":12}],
	
	"relationshipLineProp":[
	
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":0,"cableBId":"120101000002","tubeBIndex":11,"fiberBIndex":0},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":1,"cableBId":"120101000002","tubeBIndex":11,"fiberBIndex":1},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":2,"cableBId":"120101000002","tubeBIndex":11,"fiberBIndex":2},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":3,"cableBId":"120101000002","tubeBIndex":11,"fiberBIndex":3},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":4,"cableBId":"120101000002","tubeBIndex":11,"fiberBIndex":4},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":5,"cableBId":"120101000002","tubeBIndex":11,"fiberBIndex":5},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":6,"cableBId":"120101000006","tubeBIndex":10,"fiberBIndex":0},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":7,"cableBId":"120101000006","tubeBIndex":10,"fiberBIndex":1},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":8,"cableBId":"120101000006","tubeBIndex":10,"fiberBIndex":2},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":9,"cableBId":"120101000006","tubeBIndex":10,"fiberBIndex":3},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":10,"cableBId":"120101000006","tubeBIndex":10,"fiberBIndex":4},
	{"cableAId":"120101000001","tubeAIndex":0,"fiberAIndex":11,"cableBId":"120101000006","tubeBIndex":10,"fiberBIndex":5}],

	"transNames":[
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":0,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":1,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":2,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":3,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":4,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":5,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":6,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":7,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":8,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":9,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":10,"transName":"xxxxxxxx"},
		{"cableId":"120101000001","tubeIndex":0,"fiberIndex":11,"transName":"xxxxxxxx"}
	
	],


	"subCables":[
	{
		"cableId":"120101000002","tubeNum":12,"fiberNumPerTube":12,
		"subTubes":[{"tubeIndex":1,"cableId":"120101000003","fiberNum":6},{"tubeIndex":3,"cableId":"120101000005","fiberNum":6}],
		"relationshipLineProp":[
		{"cableAId":"120101000002","tubeAIndex":11,"fiberAIndex":0,"cableBId":"120101000005","tubeBIndex":3,"fiberBIndex":0},
		{"cableAId":"120101000002","tubeAIndex":11,"fiberAIndex":1,"cableBId":"120101000005","tubeBIndex":3,"fiberBIndex":1},
		{"cableAId":"120101000002","tubeAIndex":11,"fiberAIndex":2,"cableBId":"120101000005","tubeBIndex":3,"fiberBIndex":2},
		{"cableAId":"120101000002","tubeAIndex":11,"fiberAIndex":3,"cableBId":"120101000003","tubeBIndex":1,"fiberBIndex":0},
		{"cableAId":"120101000002","tubeAIndex":11,"fiberAIndex":4,"cableBId":"120101000003","tubeBIndex":1,"fiberBIndex":1},
		{"cableAId":"120101000002","tubeAIndex":11,"fiberAIndex":5,"cableBId":"120101000003","tubeBIndex":1,"fiberBIndex":2}],
		"subCables":[
		    {"cableId":"120101000003","tubeNum":6,"fiberNumPerTube":6,"subTubes":[],"relationshipLineProp":[],"subCables":[]},
		    {"cableId":"120101000005","tubeNum":6,"fiberNumPerTube":6,"subTubes":[],"relationshipLineProp":[],"subCables":[]}]
	},
				
	{
		"cableId":"120101000006",
		"tubeNum":12,"fiberNumPerTube":12,
		"subTubes":[{"tubeIndex":2,"cableId":"120101000007","fiberNum":6},{"tubeIndex":9,"cableId":"120101000008","fiberNum":12}],
		"relationshipLineProp":[
		{"cableAId":"120101000006","tubeAIndex":10,"fiberAIndex":0,"cableBId":"120101000008","tubeBIndex":9,"fiberBIndex":0},
		{"cableAId":"120101000006","tubeAIndex":10,"fiberAIndex":1,"cableBId":"120101000008","tubeBIndex":9,"fiberBIndex":1},
		{"cableAId":"120101000006","tubeAIndex":10,"fiberAIndex":2,"cableBId":"120101000008","tubeBIndex":9,"fiberBIndex":2},
		{"cableAId":"120101000006","tubeAIndex":10,"fiberAIndex":3,"cableBId":"120101000007","tubeBIndex":2,"fiberBIndex":0},
		{"cableAId":"120101000006","tubeAIndex":10,"fiberAIndex":4,"cableBId":"120101000007","tubeBIndex":2,"fiberBIndex":1},
		{"cableAId":"120101000006","tubeAIndex":10,"fiberAIndex":5,"cableBId":"120101000007","tubeBIndex":2,"fiberBIndex":2}],


		"subCables":[
		{"cableId":"120101000007","tubeNum":6,"fiberNumPerTube":6,"subTubes":[],"relationshipLineProp":[],"subCables":[]},
		{"cableId":"120101000008","tubeNum":12,"fiberNumPerTube":12,"subTubes":[],"relationshipLineProp":[],"subCables":[]}]
	}]
	};

								
								
				//console.log(cablejson);

				var cable = resloveCableJson(cablejson);

				cable.drawInSvg(group);		





				resource.select.init(document.getElementById("container"),cable);
			}	

			


			
			$(document).ready(function(){
				init();
			});
			
			var currentZoom = 1;

			function resloveCableJson(cablejson){
				if(typeof cablejson.x == "undefined" ){
					cablejson.x = 200;
				}

				if(typeof cablejson.y == "undefined" ){
					cablejson.y = 100;
				}

				if(typeof cablejson.fiberDistance == "undefined"){
					cablejson.fiberDistance = 15;
				}

				if(typeof cablejson.cableDistance == "undefined"){
					cablejson.cableDistance = 300;
				}

				
				var cable = new resource.model.Cable(cablejson);
				
				//resour(cablejson.subTubes,cablejson.relationshipLineProp,cablejson.subCables,cable);
				
				//console.log(cable);				
				return cable;


			}

			
			function zoomin(){
				currentZoom -= 0.2;
				var svgroot = document.getElementById("svgroot");			
				resource.util.assginAttribute(svgroot, {
					width: 2000*currentZoom,
					height: 3000*currentZoom,
					viewBox: '0 0 2000 3000'
				});
			}
			

			function zoomout(){
				currentZoom += 0.2;
				var svgroot = document.getElementById("svgroot");			
				resource.util.assginAttribute(svgroot, {
					width:  2000*currentZoom,
					height: 3000*currentZoom,
					viewBox: '0 0 2000 3000'
				});
			}

			function getResolution(){
				var svgcontent = document.getElementById("svgroot");
				var height = svgcontent.getAttribute('height');
				var width = svgcontent.getAttribute('width');
				return {
					'w':width,
					'h':height
				};
			}
			
			function mouseOver(evt){				
				 evt.target.setAttributeNS(null,"stroke-width","5px");
			}
			
			function mouseOut(evt){
				 evt.target.setAttributeNS(null,"stroke-width","1px");
			}
			
			function onclick(evt){
				 evt.target.setAttributeNS(null,"stroke-width","1px");
			}
			function print123(){
				var headstr = "<html><head><title></title></head><body>";
				var footstr = "</body>";  
				var printData = document.getElementById("container").innerHTML; 
				var oldHtml = document.body.innerHTML; 
				document.body.innerHTML = headstr+printData+footstr;  
				window.print();
				document.body.innerHTML = oldstr;  
			}
		</script>

	</head>

	<body>

		<div>
			<input type="button" onclick="zoomin()" value="缩小">
			<input type="button" onclick="zoomout()" value="放大">
			<input type="button" onclick="print123()" value="打印">
		</div>
		<div id="container" style="overflow: auto;
			 position:absolute;
			 display: inline-table-cell;
			 background-color: #9BCD9B;
			 border: 1px solid #808080;
			 top: 40px;
			 left: 5px;
			 bottom: 5px;
			 right: 5px;
			 width:4000;
			 height:5000;
			 ">
			<svg  xmlns  = "http://www.w3.org/2000/svg"	
			      width  = "4000"
				  height = "5000"
				  id     = "svgroot"		
				  style  = "fill:#ffffff;stroke-width:1;stroke:rgb(0,0,0);"		
				  viewBox = "0 0 4000 5000"	
				  >
			   <g id="group1">
				  
			   </g>
			</svg>
		</div>
	</body>
</html>
